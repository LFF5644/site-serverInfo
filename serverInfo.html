<?
	const os=require("os");
	const {execSync}=require("child_process");
	const {importHead}=globals.functions;
	const platform=process.platform==="linux"?"Linux":(process.platform==="win32"?"Windows":process.platform);
	const processUptime=Math.round(process.uptime());

	const cpuLogicalCores=Number(execSync("nproc").toString().trim());
	const cpuLoadAvg=execSync("cat /proc/loadavg").toString().trim().split(" ").map(Number).splice(0,3).map(item=>Math.round(item/cpuLogicalCores*10000)/100);
	const cpuOverload=cpuLoadAvg.map(item=>(item>100)?(item-100):0);
?><!DOCTYPE html>
<html>
	<head>
		<?=importHead({
			input,
			tabs: 2,
			title: "Server Info",
			script:[],
			css:[
				"/css/main.css",
				"/css/dynamic.css?imports=underLineHOVER",
			],
			watchAllow: true,
		})?>
	</head>
	<body>
		<h1>Server Info</h1>
		<p>Server Name: <b style=color:brown><?=os.hostname()?></b></p>
		<p>Platform: <b class=underLineHOVER style=cursor:pointer;color:brown onclick="location.href='//google.com/search?q=was+ist+<?=platform?>'"><?=platform?></b></p>
		<p>CPU Last in Prozent <code>(1m, 5m, 15m)</code>: <b><?=cpuLoadAvg.map(item=>`<span style=color:${item>40?(item>80?"red":"orange"):"green"}>${item>100?100:item}%</span>`).join("<span style=color:brown>,</span> ")?></b></p>
		<?if(cpuOverload.some(item=>item>0)){?><p>CPU Ãœberlast in Prozent <code>(1m, 5m, 15m)</code>: <b><?=cpuOverload.map(item=>`<span style=color:${item>0?"red":"green"}>${item}%</span>`).join("<span style=color:brown>,</span> ")?></b></p><?}?>
		<p>HTTP/Web server uptime: <b class=underLineHOVER onclick="location.href='//google.com/search?q=<?=processUptime?>+sec+to+hours'" style=cursor:pointer;color:<?=processUptime<3600?"brown":"green"?>><?=processUptime?>s</b></p>
		<p>Server System uptime: <b style=color:green><?=execSync("uptime -p").toString().trim().split("\n").join("&#10;")?></b></p>
		<p>Server Uhrzeit: <b style=color:brown><?=new Date()?></b></p>
		<p><textarea readonly style=width:100%;height:100px>Arbeitsspeicher (RAM):&#10;<?=execSync("free -h").toString().trim().split("\n").join("&#10;").split("total").join("total\t")?></textarea></p>
		<p><textarea readonly style=width:100%;height:200px>Processor Informationen:&#10;<?=execSync("lscpu").toString().trim().split("\n").join("&#10;")?></textarea></p>
		<p><textarea readonly style=width:100%;height:200px>Datei System:&#10;<?=execSync("df -h").toString().trim().split("\n").join("&#10;")?></textarea></p>
		<p><textarea readonly style=width:100%;height:200px>Arbeitsspeicher Details:&#10;<?=execSync("cat /proc/meminfo").toString().trim().split("\n").join("&#10;")?></textarea></p>
	</body>
</html>